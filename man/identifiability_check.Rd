% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/identifiability.R
\name{identifiability_check}
\alias{identifiability_check}
\title{Check model identifiability}
\usage{
identifiability_check(
  spec,
  y,
  par = NULL,
  level = c("local", "profile"),
  threshold = 0.01,
  verbose = FALSE,
  cl = NULL
)
}
\arguments{
\item{spec}{A \code{model_spec} object}

\item{y}{Numeric vector of observed data}

\item{par}{Named numeric vector of parameter values. If NULL, attempts to
find MLE first.}

\item{level}{Analysis level: "local" uses Fisher information only,
"profile" adds profile likelihood analysis}

\item{threshold}{Eigenvalue threshold for non-identifiability (default 0.01)}

\item{verbose}{Logical; print progress information}

\item{cl}{Optional parallel cluster from \code{setup_cluster()}. If provided,
profile likelihood computations run in parallel.}
}
\value{
An S3 object of class \code{identifiability_result} containing:
\describe{
\item{status}{Named character vector of identifiability status per parameter}
\item{fisher_info}{The Fisher information analysis}
\item{identified_functions}{Character vector of identified parameter combinations}
\item{non_identified}{Character vector of non-identified directions}
\item{condition}{Condition number}
\item{rank}{Numerical rank}
\item{recommendations}{Suggested actions}
}
}
\description{
Perform comprehensive identifiability analysis for a model specification.
Combines Fisher information analysis with profile likelihood diagnostics.
}
\examples{
# Well-identified model
norm_spec <- model_spec(
  loglik_fn = function(y, mu, sigma) {
    sum(dnorm(y, mean = mu, sd = sigma, log = TRUE))
  },
  par_names = c("mu", "sigma"),
  par_bounds = list(sigma = c(1e-6, Inf))
)

set.seed(123)
y <- rnorm(100, mean = 5, sd = 2)
result <- identifiability_check(norm_spec, y, par = c(mu = 5, sigma = 2))
print(result)

# Non-identifiable model
nonid_spec <- model_spec(
  loglik_fn = function(y, a, b) {
    sum(dnorm(y, mean = a + b, sd = 1, log = TRUE))
  },
  par_names = c("a", "b")
)

result2 <- identifiability_check(nonid_spec, y, par = c(a = 2, b = 3))
print(result2)
}
