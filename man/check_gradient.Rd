% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/validate.R
\name{check_gradient}
\alias{check_gradient}
\title{Check numerical gradient against analytical}
\usage{
check_gradient(spec, y, par, grad_fn, tol = 1e-04)
}
\arguments{
\item{spec}{A \code{model_spec} object}

\item{y}{Numeric vector of data}

\item{par}{Named numeric vector of parameter values}

\item{grad_fn}{Analytical gradient function with signature \verb{function(y, ...)}}

\item{tol}{Tolerance for comparison (default 1e-4)}
}
\value{
Logical indicating whether gradients match
}
\description{
Compare numerically computed gradient with a user-supplied analytical
gradient function.
}
\examples{
# For normal distribution, gradient w.r.t. mu is sum(y - mu) / sigma^2
spec <- model_spec_normal()
y <- rnorm(100, 5, 2)
grad_fn <- function(y, mu, sigma) {
  c(mu = sum(y - mu) / sigma^2,
    sigma = -length(y) / sigma + sum((y - mu)^2) / sigma^3)
}
check_gradient(spec, y, c(mu = 5, sigma = 2), grad_fn)
}
