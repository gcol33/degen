% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/identifiability.R
\name{profile_ci}
\alias{profile_ci}
\title{Compute profile likelihood confidence intervals}
\usage{
profile_ci(spec, y, par, level = 0.95, n_points = 50, which_par = NULL)
}
\arguments{
\item{spec}{A \code{model_spec} object}

\item{y}{Numeric vector of observed data}

\item{par}{Named numeric vector of parameter values (typically MLE)}

\item{level}{Confidence level (default 0.95)}

\item{n_points}{Number of points for profile likelihood (default 50)}

\item{which_par}{Optional character vector of parameter names to compute CIs for.
If NULL (default), computes CIs for all parameters.}
}
\value{
A data frame with columns:
\describe{
\item{parameter}{Parameter name}
\item{estimate}{Point estimate (from \code{par})}
\item{lower}{Lower confidence bound}
\item{upper}{Upper confidence bound}
\item{level}{Confidence level}
}
}
\description{
Extract confidence intervals from profile likelihood curves using the
likelihood ratio test criterion.
}
\details{
The confidence interval is based on the likelihood ratio test. For a given
confidence level, the interval includes all parameter values where the
profile log-likelihood is within \code{qchisq(level, df=1)/2} of the maximum.
}
\examples{
spec <- model_spec(
  loglik_fn = function(y, mu, sigma) sum(dnorm(y, mu, sigma, log = TRUE)),
  par_names = c("mu", "sigma"),
  par_bounds = list(sigma = c(1e-6, Inf))
)
set.seed(123)
y <- rnorm(100, mean = 5, sd = 2)
ci <- profile_ci(spec, y, par = c(mu = 5, sigma = 2))
print(ci)
}
