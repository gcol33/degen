% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fisher_information.R
\name{fisher_information}
\alias{fisher_information}
\title{Compute Fisher information matrix}
\usage{
fisher_information(
  spec,
  y,
  par,
  type = c("observed", "expected"),
  method = c("hessian"),
  cl = NULL
)
}
\arguments{
\item{spec}{A \code{model_spec} object}

\item{y}{Numeric vector of observed data}

\item{par}{Named numeric vector of parameter values at which to evaluate}

\item{type}{Type of information: "observed" (default) uses the negative
Hessian at the data; "expected" uses the outer product of gradients (OPG)
estimator computed from per-observation score contributions}

\item{method}{Computation method: "hessian" (default) uses numerical
differentiation}

\item{cl}{Optional parallel cluster from \code{setup_cluster()}. Only used for
\code{type = "expected"} to parallelize per-observation score computation.}
}
\value{
An S3 object of class \code{fisher_info} containing:
\describe{
\item{matrix}{The Fisher information matrix}
\item{eigenvalues}{Eigenvalues (sorted decreasing)}
\item{eigenvectors}{Corresponding eigenvectors}
\item{condition}{Condition number}
\item{rank}{Numerical rank}
\item{par}{Parameter values used}
\item{par_names}{Parameter names}
\item{type}{Type of information computed}
}
}
\description{
Compute the Fisher information matrix for a model specification at given
parameter values. Supports both observed information (negative Hessian) and
expected information (outer product of gradients estimator).
}
\details{
The Fisher information matrix characterizes the curvature of the
log-likelihood surface. Key properties:
\itemize{
\item Positive definite: all parameters locally identifiable
\item Singular (rank deficient): some parameters not identifiable
\item Near-singular (high condition number): some parameters weakly identified
}

Two types of information are available:
\itemize{
\item \strong{Observed information} (\code{type = "observed"}): The negative Hessian of
the log-likelihood. This is the default and most common choice.
\item \strong{Expected information} (\code{type = "expected"}): Estimated using the outer
product of gradients (OPG), where scores are summed over observations.
The score is the gradient of the log-likelihood for each observation.
Under regularity conditions,
this converges to the same limit as observed information but may differ
in finite samples. Requires the log-likelihood to be additive over
observations.
}
}
\examples{
spec <- model_spec(
  loglik_fn = function(y, mu, sigma) {
    sum(dnorm(y, mean = mu, sd = sigma, log = TRUE))
  },
  par_names = c("mu", "sigma"),
  par_bounds = list(sigma = c(1e-6, Inf))
)

set.seed(123)
y <- rnorm(100, mean = 5, sd = 2)

# Observed information (negative Hessian)
info_obs <- fisher_information(spec, y, par = c(mu = 5, sigma = 2))
print(info_obs)

# Expected information (OPG estimator)
info_exp <- fisher_information(spec, y, par = c(mu = 5, sigma = 2),
                               type = "expected")
print(info_exp)
}
