% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fisher_information.R
\name{fisher_information}
\alias{fisher_information}
\title{Compute Fisher information matrix}
\usage{
fisher_information(
  spec,
  y,
  par,
  type = c("observed", "expected"),
  method = c("hessian")
)
}
\arguments{
\item{spec}{A \code{model_spec} object}

\item{y}{Numeric vector of observed data}

\item{par}{Named numeric vector of parameter values at which to evaluate}

\item{type}{Type of information: "observed" (default) uses the negative
Hessian at the data; "expected" would use theoretical expectation
(not yet implemented)}

\item{method}{Computation method: "hessian" (default) uses numerical
differentiation}
}
\value{
An S3 object of class \code{fisher_info} containing:
\describe{
\item{matrix}{The Fisher information matrix}
\item{eigenvalues}{Eigenvalues (sorted decreasing)}
\item{eigenvectors}{Corresponding eigenvectors}
\item{condition}{Condition number}
\item{rank}{Numerical rank}
\item{par}{Parameter values used}
\item{par_names}{Parameter names}
}
}
\description{
Compute the observed Fisher information matrix (negative Hessian of
log-likelihood) for a model specification at given parameter values.
}
\details{
The Fisher information matrix characterizes the curvature of the
log-likelihood surface. Key properties:
\itemize{
\item Positive definite: all parameters locally identifiable
\item Singular (rank deficient): some parameters not identifiable
\item Near-singular (high condition number): some parameters weakly identified
}
}
\examples{
spec <- model_spec(
  loglik_fn = function(y, mu, sigma) {
    sum(dnorm(y, mean = mu, sd = sigma, log = TRUE))
  },
  par_names = c("mu", "sigma"),
  par_bounds = list(sigma = c(1e-6, Inf))
)

set.seed(123)
y <- rnorm(100, mean = 5, sd = 2)
info <- fisher_information(spec, y, par = c(mu = 5, sigma = 2))
print(info)
}
