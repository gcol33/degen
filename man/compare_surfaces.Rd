% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compare_surfaces.R
\name{compare_surfaces}
\alias{compare_surfaces}
\title{Compare likelihood surfaces between two models}
\usage{
compare_surfaces(
  pair,
  y,
  n_points = 100,
  method = c("grid", "optimization"),
  tol = 1e-06,
  verbose = FALSE,
  progress = interactive(),
  cl = NULL
)
}
\arguments{
\item{pair}{An \code{equivalence_pair} object}

\item{y}{Numeric vector of observed data}

\item{n_points}{Number of parameter points to sample (default 100)}

\item{method}{Comparison method: "grid" samples parameter space,
"optimization" searches for counterexamples}

\item{tol}{Tolerance for likelihood equality (default 1e-6)}

\item{verbose}{Logical; print progress information}

\item{progress}{Logical; show progress bar with ETA (default TRUE in
interactive sessions). Set to FALSE to suppress progress output.}

\item{cl}{Optional parallel cluster from \code{setup_cluster()}. If provided,
grid points are evaluated in parallel.}
}
\value{
An S3 object of class \code{surface_comparison} containing:
\describe{
\item{equivalent}{Logical; overall equivalence conclusion}
\item{max_discrepancy}{Maximum likelihood discrepancy found}
\item{n_tested}{Number of parameter points tested}
\item{evidence}{Data frame of tested points and discrepancies}
\item{tol}{Tolerance used}
\item{method}{Method used}
}
}
\description{
Test whether two model specifications are observationally equivalent by
comparing their likelihood surfaces. For each parameter configuration of
model A, the algorithm searches for a configuration of model B that produces
the same likelihood.
}
\details{
The comparison is performed in both directions (A to B and B to A) to ensure
the equivalence relation is symmetric.

Note that this provides numerical evidence, not mathematical proof. A
conclusion of equivalence means no counterexample was found within the
tested region of parameter space.
}
\examples{
# Compare exponential and gamma(shape=1) - these are equivalent
exp_spec <- model_spec(
  loglik_fn = function(y, lambda) sum(dexp(y, rate = lambda, log = TRUE)),
  par_names = "lambda",
  par_bounds = list(lambda = c(1e-6, Inf)),
  name = "Exponential"
)

gamma_spec <- model_spec(
  loglik_fn = function(y, rate) {
    sum(dgamma(y, shape = 1, rate = rate, log = TRUE))
  },
  par_names = "rate",
  par_bounds = list(rate = c(1e-6, Inf)),
  name = "Gamma(1)"
)

pair <- equivalence_pair(exp_spec, gamma_spec)
set.seed(123)
y <- rexp(100, rate = 2)
result <- compare_surfaces(pair, y, n_points = 20)
print(result)
}
